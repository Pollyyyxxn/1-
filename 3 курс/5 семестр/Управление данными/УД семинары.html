<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>notepad</title>
</head>
<style type="text/css">
ol,ul{
display:block;
list-style-type:none;
margin:3px;
}
</style><body>
<div><div style ="margin-left:160px;"><b><font color ="#ffbf00">1 &#1057;&#1045;&#1052;&#1048;&#1053;&#1040;&#1056;</font></b><br>
</div><br>
<b>&#1055;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103;</b><br>
1.SELECT Sotr_id, Fio, Salary FROM Sotr<br>
<br>
2.SELECT Sotr_id, Fio, Salary INTO &#1047;&#1072;&#1088;&#1087;&#1083;&#1072;&#1090;&#1072;1 FROM Sotr<br>
<br>
CREATE TABLE &#1047;&#1072;&#1088;&#1087;&#1083;&#1072;&#1090;&#1072;1 (...)<br>
INSERT INTO &#1047;&#1072;&#1088;&#1087;&#1083;&#1072;&#1090;&#1072;1 SELECT Sotr_id, Fio, Salary FROM Sotr<br>
<br>
3.CREATE VIEW SotrSalary AS SELECT Sotr_id, Salary, Fio FROM Sotr<br>
<br>
5.CREATE VIEW CountSotrInProj AS SELECT Proj_n, COUNT(*) AS Count_Sotr FROM Project GROUP BY Proj_n<br>
<br>
6.CREATE VIEW OldSotr AS SELECT DISTINCT Sotr.Fio, Sotr.Sotr_id FROM Sotr JOIN Project ON Sotr.Sotr_id = Project.Sotr_id WHERE YEAR (GETDATE()) - YEAR (Sotr.Birthday) &gt; 60 <br>
&#1080;&#1083;&#1080;<br>
CREATE VIEW OldSotr AS SELECT DISTINCT Sotr.Fio, Sotr.Sotr_id FROM Sotr JOIN Project ON Sotr.Sotr_id = Project.Sotr_id WHERE DATEDIFF(Year, Sotr.Birhday, GETDATE()) &gt; 60<br>
<br>
<b>&#1059;&#1089;&#1083;&#1086;&#1074;&#1085;&#1099;&#1077; &#1082;&#1086;&#1085;&#1089;&#1090;&#1088;&#1091;&#1082;&#1094;&#1080;&#1080;</b><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 1.</b><br>
DECLARE @m_count INT, @w_count INT<br>
SELECT @m_count = COUNT (gender) FROM Sotr WHERE gender = 'm' AND dep=3 <br>
SELECT @w_count = COUNT (gender) FROM Sotr WHERE gender = '&#1078;' AND dep=3<br>
IF @w_count &gt; @m_count <br>
<div style ="margin-left:64px;">PRINT '&#1046;&#1077;&#1085;&#1097;&#1080;&#1085; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077;' <br>
</div>ELSE IF @m_count = @m_count <br>
<div style ="margin-left:64px;">PRINT '&#1050;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1088;&#1072;&#1074;&#1085;&#1086;' <br>
</div>ELSE <br>
<div style ="margin-left:64px;">PRINT '&#1052;&#1091;&#1078;&#1095;&#1080;&#1085; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077;'<br>
</div><div style ="margin-left:64px;"><br>
</div><b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 2.</b><br>
DECLARE @avg_salary DECIMAL, @rich INT, @broke INT<br>
SELECT @avg_salary = AVG(salary) FROM Sotr<br>
SELECT @rich&nbsp; COUNT(*) FROM Sotr WHERE salary &gt; @avg_salary<br>
SELECT @broke = COUNT(*) FROM Sotr WHERE salary &lt; @avg_salary<br>
IF @rich &gt; @broke<br>
<div style ="margin-left:64px;">PRINT '&#1041;&#1086;&#1075;&#1072;&#1090;&#1099;&#1093; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077;'<br>
</div>ELSE IF @rich &lt; @broke<br>
<div style ="margin-left:64px;">PRINT '&#1041;&#1077;&#1076;&#1085;&#1099;&#1093; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077;'<br>
</div>ELSE <br>
<div style ="margin-left:64px;">PRINT '&#1054;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1077; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;'<br>
</div><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 3.</b><br>
SELECT NameGroup, Kurs,<br>
<div style ="margin-left:32px;">Case Kafedra<br>
</div><div style ="margin-left:64px;">WHEN '&#1055;&#1052;' THEN '&#1055;&#1088;&#1080;&#1082;&#1083;&#1072;&#1076;&#1085;&#1072;&#1103; &#1084;&#1072;&#1090;&#1077;&#1084;&#1072;&#1090;&#1080;&#1082;&#1072;'<br>
</div><div style ="margin-left:64px;">WHEN '&#1048;&#1057;' THEN '&#1048;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1077; &#1089;&#1080;&#1089;&#1090;&#1077;&#1084;&#1099;'<br>
</div><div style ="margin-left:64px;">WHEN '&#1048;&#1043;' THEN '&#1048;&#1085;&#1078;&#1077;&#1085;&#1077;&#1088;&#1085;&#1072;&#1103; &#1075;&#1088;&#1072;&#1092;&#1080;&#1082;&#1072;'<br>
</div><div style ="margin-left:32px;">ELSEKafedra<br>
</div><div style ="margin-left:32px;">END AS Kafedra FROM Sotr<br>
</div><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 4.</b><br>
DECLARE @mark INT, @text_mark VARCHAR (20)<br>
IF @mark &lt; 25<br>
<div style ="margin-left:32px;">SET @text_mark = '&#1085;&#1077;&#1091;&#1076;'<br>
</div>ELSE IF @mark &lt; 35<br>
<div style ="margin-left:32px;">SET @text_mark = '&#1091;&#1076;&#1086;&#1074;&#1083;&#1077;&#1090;&#1074;&#1086;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;'<br>
</div>ELSE IF @mark &lt; 45<br>
<div style ="margin-left:32px;">SET @text_mark = '&#1093;&#1086;&#1088;&#1086;&#1096;&#1086;'<br>
</div>ELSE<br>
<div style ="margin-left:32px;">SET @text_mark = '&#1086;&#1090;&#1083;&#1080;&#1095;&#1085;&#1086;'<br>
</div><br>
Case <br>
&nbsp;&nbsp;&nbsp;&nbsp; WHEN @mark &lt; 25 THEN '&#1085;&#1077;&#1091;&#1076;'<br>
&nbsp;&nbsp;&nbsp;&nbsp; WHEN @mark &lt;35 THEN '&#1091;&#1076;&#1086;&#1074;&#1083;&#1077;&#1090;&#1074;&#1086;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;'<br>
&nbsp;&nbsp;&nbsp;&nbsp; WHEN @mark &lt;45 THEN '&#1093;&#1086;&#1088;&#1086;&#1096;&#1086;'<br>
&nbsp;&nbsp;&nbsp;&nbsp; ELSE '&#1086;&#1090;&#1083;&#1080;&#1095;&#1085;&#1086;'<br>
END<br>
PRINT @text_mark<br>
<br>
<br>
<div style ="margin-left:128px;"><b><font color ="#ffbf00">2 &#1057;&#1045;&#1052;&#1048;&#1053;&#1040;&#1056;</font></b><br>
</div><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 5</b><br>
//SELECT COUNT(*) FROM Proj GROUP BY Sotr_id<br>
<br>
SELECT Sotr_id CASE WHEN COUNT (*) BETWEEN 1 AND 2 THEN '&#1054;&#1095;&#1077;&#1085;&#1100; &#1088;&#1077;&#1076;&#1082;&#1086;'<br>
WHEN COUNT (*) BETWEEN 3 AND 4 THEN ''&#1048;&#1085;&#1086;&#1075;&#1076;&#1072;'<br>
ELSE '&#1063;&#1072;&#1089;&#1090;&#1086;'<br>
END AS '&#1063;&#1072;&#1089;&#1090;&#1086;&#1090;&#1072;'<br>
FROM Project GROUP BY Sotr_id<br>
UNION<br>
SELECT Sotr_id '&#1053;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072;' FROM Sotr WHERE Sotr_id NOT IN (SELECT Sotr_id FROM Project) / WHERE EXISTS (SELECT (*) FROM Project WHERE Project.Sotr_id = Sotr.Sotr_id)<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 6</b><br>
SELECT Sotr.Sotr_id, Sotr.Fio CASE WHEN COUNT (*) BETWEEN 1 AND 2 THEN '&#1054;&#1095;&#1077;&#1085;&#1100; &#1088;&#1077;&#1076;&#1082;&#1086;'<br>
WHEN COUNT (*) BETWEEN 3 AND 4 THEN ''&#1048;&#1085;&#1086;&#1075;&#1076;&#1072;'<br>
ELSE '&#1063;&#1072;&#1089;&#1090;&#1086;'<br>
END AS '&#1063;&#1072;&#1089;&#1090;&#1086;&#1090;&#1072;'<br>
FROM Sotr JOIN Project ON Sotr.Sotr_id = Project.Sotr_id GROUP BY Sotr.Sotr_id, Sotr.Fio<br>
UNION <br>
SELECT Sotr_id, Sotr.Fio '&#1053;&#1080;&#1082;&#1086;&#1075;&#1076;&#1072;' FROM Sotr WHERE Sotr_id NOT IN (SELECT Sotr_id FROM Project) / WHERE NOT EXISTS (SELECT (*) FROM Project WHERE Project.Sotr_id = Sotr.Sotr_id)<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 7</b><br>
DECLARE @otl INT, @hor INT, @udovl INT<br>
SET @otl = COUNT (*) FROM Exam, Student WHERE Exam.id_stident = Student.id_student AND MArk=5 AND NameGroup = '&#1048;&#1044;&#1041;-22-04' AND Subject = '&#1040;&#1088;&#1093;&#1080;&#1090;&#1077;&#1082;&#1090;&#1091;&#1088;&#1072; &#1069;&#1042;&#1052;'<br>
SELECT @hor = COUNT (*) FROM Exam, Student WHERE Exam.id_stident = Student.id_student AND Mark=4 AND NameGroup = '&#1048;&#1044;&#1041;-22-04' AND Subject = '&#1040;&#1088;&#1093;&#1080;&#1090;&#1077;&#1082;&#1090;&#1091;&#1088;&#1072; &#1069;&#1042;&#1052;'<br>
SELECT @udovl = COUNT (*) FROM Exam, Student WHERE Exam.id_stident = Student.id_student AND Mark = 3 AND NameGroup = '&#1048;&#1044;&#1041;-22-04' AND Subject = '&#1040;&#1088;&#1093;&#1080;&#1090;&#1077;&#1082;&#1090;&#1091;&#1088;&#1072; &#1069;&#1042;&#1052;'<br>
IF @otl &gt; @hor AND @otl &gt; @udovl <br>
<div style ="margin-left:32px;">PRINT '&#1054;&#1090;&#1083;&#1080;&#1095;&#1085;&#1086;'<br>
</div>ELSE IF @hor &gt; @otl AND @hor &gt; @udovl<br>
<div style ="margin-left:32px;">PRINT '&#1061;&#1086;&#1088;&#1086;&#1096;&#1086;'<br>
</div>ELSE IF @udovl &gt; @otl AND @udovl &gt; @hor<br>
<div style ="margin-left:32px;">PRINT '&#1059;&#1076;&#1086;&#1074;&#1083;&#1077;&#1090;&#1074;&#1086;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;'<br>
</div>ELSE @otl = @hor AND @otl = @udovl AND @hor = @udovl<br>
<div style ="margin-left:32px;">PRINT '&#1054;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;'<br>
</div><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 8</b><br>
<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 9</b><br>
SELECT Sotr.Sotr_id, Sotr.Fio, Sotr.Dep<br>
CASE<br>
<div style ="margin-left:32px;">WHEN Sotr.Dep = 1 THEN '15%'<br>
</div><div style ="margin-left:32px;">WHEN Sotr.Dep = 3 THEN '10%'<br>
</div><div style ="margin-left:64px;">ELSE '5%',<br>
</div><div style ="margin-left:32px;">END AS [&#1055;&#1088;&#1086;&#1094;&#1077;&#1085;&#1090; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;],<br>
</div>CASE<br>
<div style ="margin-left:32px;">WHEN Sotr.Dep = 1 THEN&nbsp; Sotr.Salary * 0,15<br>
</div><div style ="margin-left:32px;">WHEN Sotr.Dep = 3 THEN Sotr.Salary * 0,1<br>
</div><div style ="margin-left:64px;">ELSE Sotr.Salary * 0,05<br>
</div><div style ="margin-left:32px;">END AS [&#1057;&#1091;&#1084;&#1084;&#1072; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;],<br>
</div>FROM Sotr<br>
<br>
<br>
<div align="left" ><font color ="#ffbf00"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 &#1057;&#1045;&#1052;&#1048;&#1053;&#1040;&#1056;</b></font><br>
</div><br>
&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 1<br>
DECLARE @name VARCHAR(20), @fam VARCHAR(20)<br>
DECLARE client_cursos CURSOR FOR<br>
SELECT name, fam FROM Client ORDER BY fam, name<br>
OPEN client_cursor<br>
FETCH NEXT FROM client_cursor INTO @name, @fam<br>
WHILE @@FETCH_STATUS = 0<br>
BEGIN<br>
&nbsp;&nbsp;&nbsp; PRINT @fam + ' ' + @name<br>
&nbsp;&nbsp;&nbsp; FETCH NEXT FROM client_cursor INTO @name, @fam<br>
END<br>
CLOSE client_cursor<br>
DEALLOCATE client_cursor<br>
<br>
&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 1 (&#1089; &#1085;&#1091;&#1084;&#1077;&#1088;&#1072;&#1094;&#1080;&#1077;&#1081;)<br>
DECLARE @name VARCHAR(20), @fam VARCHAR(20), @it INT<br>
DECLARE client_cursos CURSOR FOR<br>
SELECT name, fam FROM Client ORDER BY fam, name<br>
SET @it = 1<br>
OPEN client_cursor<br>
FETCH NEXT FROM client_cursor INTO @name, @fam<br>
WHILE @@FETCH_STATUS = 0<br>
BEGIN<br>
&nbsp;&nbsp;&nbsp; PRINT CAST (@it AS VARCHAR(20)) + ' ' +&nbsp; @fam + ' ' + @name<br>
&nbsp;&nbsp;&nbsp; FETCH NEXT FROM client_cursor INTO @name, @fam<br>
&nbsp;&nbsp;&nbsp; SET @it = @it + 1<br>
END<br>
CLOSE client_cursor<br>
DEALLOCATE client_cursor<br>
<br>
&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 2<br>
DECLARE studentMark CURSOR FOR<br>
SELECT Id_Student, min(Mark) FROM Exam GROUP BY Id_Student, Mark<br>
DECLARE @stud_id INT, @stud_mark INT<br>
DECLARE @tmp TABLE (stud_num INT, mark VARCHAR(20))<br>
OPEN studentMark<br>
FETCH NEXT FROM studentMark INTO @stud_id, @stud_mark<br>
WHILE @@FETCH_STATUS = 0<br>
BEGIN<br>
&nbsp;&nbsp;&nbsp; IF @stud_mark INSERT INTO @tmp VALUES (@stud_id, '&#1089; &#1090;&#1088;&#1086;&#1081;&#1082;&#1072;&#1084;&#1080;')<br>
&nbsp;&nbsp;&nbsp; IF @stud_mark = 4 INSERT INTO @tmp VALUES (@stud_id, '&#1089; &#1095;&#1077;&#1090;&#1074;&#1077;&#1088;&#1082;&#1072;&#1084;&#1080;')<br>
&nbsp;&nbsp;&nbsp; IF @stud_mark = 5 INSERT INTO @tmp VALUES (@stud_id, '&#1089; &#1087;&#1103;&#1090;&#1077;&#1088;&#1082;&#1072;&#1084;&#1080;')<br>
&nbsp;&nbsp;&nbsp; FETCH NEXT FROM studentMark INTO @stud_id, @stud_mark<br>
END<br>
SELECT * FROM @tmp <br>
CLOSE studentMark<br>
DEALLOCATE studentMark<br>
<br>
&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 3<br>
DECLARE @newS DECIMAL(8,2)<br>
DECLARE new_cursor CURSOR LOCAL FORWARD_ONLY DYNAMIC OPTIMISTIC FOR<br>
SELECT Oklad, Stage, Bonus FROM TCalc<br>
OPEN new_cursor<br>
DECLARE @ok INT, @st INT, @bon INT<br>
FETCH NEXT FROM new_cursor INTO @ok, @st, @bon<br>
WHILE @@FETCH_STATUS = 0<br>
BEGIN<br>
&nbsp;&nbsp;&nbsp; SET @newS = CASE<br>
&nbsp;&nbsp;&nbsp; WHEN @st BETWEEN 10 AND 15 THEN 1,1 * @ok<br>
&nbsp;&nbsp;&nbsp; WHEN @st BETWEEN 15 AND 20 THEN 1,2 * @ok<br>
&nbsp;&nbsp;&nbsp; WHEN @st BETWEEN 20 AND 25 THEN 1,25 * @ok<br>
&nbsp;&nbsp;&nbsp; ELSE @ok<br>
END<br>
IF @bon IS NOT NULL SET @newS = @newS + @bon<br>
UPDATE TCalc SET salary = @newS WHERE CURRENT OFF new_cursor<br>
FETCH NEXT FROM new_cursor INTO @ok, @st, @bon<br>
END<br>
CLOSE new_cursor<br>
DEALLOCATE new_cursor<br>
<br>
<br>
<br>
<br>
<div style ="margin-left:128px;"><b><font color ="#ffbf00">3 &#1057;&#1045;&#1052;&#1048;&#1053;&#1040;&#1056;</font></b><br>
</div><br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 1</b><br>
&#1050;&#1086;&#1084;&#1087;&#1072;&#1085;&#1080;&#1103; &#1093;&#1086;&#1095;&#1077;&#1090; &#1074;&#1099;&#1087;&#1083;&#1072;&#1090;&#1080;&#1090;&#1100; &#1074;&#1089;&#1077;&#1084; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072;&#1084; &#1087;&#1077;&#1088;&#1074;&#1086;&#1075;&#1086; &#1086;&#1090;&#1076;&#1077;&#1083;&#1072; &#1087;&#1088;&#1077;&#1084;&#1080;&#1102; &#1074; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1077; 20% &#1086;&#1090; &#1079;&#1072;&#1088;&#1087;&#1083;&#1072;&#1090;&#1099;. &#1054;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1086;&#1073;&#1097;&#1091;&#1102; &#1089;&#1091;&#1084;&#1084;&#1091; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1074;&#1099;&#1087;&#1083;&#1072;&#1090;. &#1054;&#1092;&#1086;&#1088;&#1084;&#1080;&#1090;&#1100; &#1079;&#1072;&#1087;&#1088;&#1086;&#1089; &#1074; &#1074;&#1080;&#1076;&#1077; &#1093;&#1088;&#1072;&#1085;&#1080;&#1084;&#1086;&#1081; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099; &#1089; &#1074;&#1099;&#1093;&#1086;&#1076;&#1085;&#1099;&#1084; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1084;.<br>
<br>
CREATE PROCEDURE Bonus<br>
@TOTAL_BONUS DECIMAL (8,2) OUTPUT<br>
AS<br>
SELECT @TOTAL_BONUS = SUM(Salary*0,2) FROM Sotr WHERE Dep=1<br>
DECLARE @Payment DECIMAL (8,2)<br>
EXEC Bonus @Payment OUTPUT<br>
PRINT @Payment<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 2</b><br>
&#1055;&#1077;&#1088;&#1077;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1091;&#1102; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091;, &#1091;&#1082;&#1072;&#1079;&#1072;&#1074; &#1085;&#1086;&#1084;&#1077;&#1088; &#1086;&#1090;&#1076;&#1077;&#1083;&#1072; &#1080; &#1087;&#1088;&#1086;&#1094;&#1077;&#1085;&#1090; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093;, &#1082;&#1072;&#1082; &#1074;&#1093;&#1086;&#1076;&#1085;&#1099;&#1077; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;.<br>
<br>
CREATE PROCEDURE Bonus @Dep INT, @Proc INT,<br>
@TOTAL_BONUS DECIMAL (8,2) OUTPUT<br>
AS<br>
SELECT @TOTAL_BONUS = SUM(Salary*@Proc/100) FROM Sotr WHERE Dep=1<br>
DECLARE @P DECIMAL (8,2)<br>
EXEC Bonus 1, 20, @P OUTPUT<br>
PRINT @P<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 3</b><br>
&#1053;&#1072; &#1086;&#1089;&#1085;&#1086;&#1074;&#1077; &#1087;&#1088;&#1077;&#1076;&#1099;&#1076;&#1091;&#1097;&#1077;&#1081; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099;, &#1089;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1085;&#1086;&#1074;&#1091;&#1102;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081; &#1086;&#1090;&#1076;&#1077;&#1083;&#1100;&#1085;&#1086; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085; &#1087;&#1088;&#1086;&#1094;&#1077;&#1085;&#1090; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1076;&#1083;&#1103; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; &#1080; &#1087;&#1088;&#1086;&#1094;&#1077;&#1085;&#1090; &#1087;&#1088;&#1077;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1076;&#1083;&#1103; &#1088;&#1091;&#1082;&#1086;&#1074;&#1086;&#1076;&#1089;&#1090;&#1074;&#1072; (&#1076;&#1086;&#1083;&#1078;&#1085;&#1086;&#1089;&#1090;&#1100; &#8211; &#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1080;&#1082;).<br>
<br>
CREATE PROCEDURE Bonus @Dep INT, @P1 INT, @P2 INT,<br>
@Total DECIMAL (8,2) OUTPUT<br>
AS<br>
BEGIN<br>
SELECT @Total = SUM(SALARY * @P1 / 100) FROM Sotr WHERE Dep=@Dep AND job LIKE '%&#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1080;&#1082;%'<br>
<div align="left" >SELECT @Total = @Total (+ SUM(Salary*@P2 / 100) FROM Sotr WHERE Dep=@Dep AND job NOT LIKE '%&#1085;&#1072;&#1095;&#1072;&#1083;&#1100;&#1085;&#1080;&#1082;%'<br>
</div><div align="left" >DECLARE @result DECIMAL (8,2)<br>
</div><div align="left" >EXEC Bonus 1, 35, 5, @res OUTPUT<br>
</div><div align="left" >PRINT @result<br>
</div><div align="left" ><br>
</div><div align="left" ><b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 4</b><br>
</div><div align="left" >&#1042;&#1099;&#1074;&#1077;&#1089;&#1090;&#1080; &#1091;&#1087;&#1086;&#1088;&#1103;&#1076;&#1086;&#1095;&#1077;&#1085;&#1085;&#1099;&#1081; &#1087;&#1086; &#1092;&#1072;&#1084;&#1080;&#1083;&#1080;&#1080; &#1089;&#1087;&#1080;&#1089;&#1086;&#1082; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; (&#1085;&#1086;&#1084;&#1077;&#1088;&#1072; &#1080; &#1092;&#1072;&#1084;&#1080;&#1083;&#1080;&#1080;), &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1086;&#1075;&#1091;&#1090; &#1074;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100; &#1091;&#1082;&#1072;&#1079;&#1072;&#1085;&#1085;&#1086;&#1077; &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;. &#1056;&#1077;&#1072;&#1083;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080;, &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1102;&#1097;&#1077;&#1081; &#1090;&#1072;&#1073;&#1083;&#1080;&#1095;&#1085;&#1086;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;.<br>
</div><div align="left" ><br>
</div><div align="left" >CREATE FUNCTION GetEmpTasks (@task VARCHAR(50))<br>
</div><div align="left" >RETURNS TABLE <br>
</div><div align="left" >AS BEGIN<br>
</div><div align="left" >RETURN<br>
</div><div align="left" >SELECT Sotr_id, FIO FROM Sotr WHERE (SELECT Task FROM Project WHERE Project.Sotr_id = Sotr.Sotr_id) ORDER BY FIO<br>
</div><div align="left" >END<br>
</div><div align="left" >SELECT * FROM GetEmpTask ('&#1086;&#1090;&#1095;&#1077;&#1090;')<br>
</div><div align="left" >ORDER BY FIO<br>
</div><div align="left" ><br>
</div><div align="left" ><b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 5</b><br>
</div><div align="left" >&#1053;&#1072;&#1087;&#1080;&#1089;&#1072;&#1090;&#1100; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;, &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1102;&#1097;&#1091;&#1102; &#1085;&#1086;&#1084;&#1077;&#1088; &#1086;&#1090;&#1076;&#1077;&#1083;&#1072;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090; &#1085;&#1072;&#1080;&#1084;&#1077;&#1085;&#1100;&#1096;&#1077;&#1077; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074;.<br>
</div><div align="left" ><br>
</div>CREATE FUNCTION Find()<br>
RETURNS INT<br>
AS<br>
BEGIN<br>
DECLARE @tmp TABLE (numb INT, sotrCount INT)<br>
INSERT INTO @tmp SELECT Dep, COUNT(*) FROM Sotr GROUP BY Dep<br>
DECLARE @min INT<br>
SET @min = (SELECT MIN(SotrCount) FROM @tmp)<br>
DECLARE @res INT<br>
SET @res = (SELECT numb FROM @tmp WHERE SotrCount = @min)<br>
RETURN @res<br>
END<br>
PRINT Find()<br>
<br>
<b>&#1047;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; 6</b><br>
&#1042;&#1099;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1100; &#1087;&#1077;&#1088;&#1077;&#1074;&#1086;&#1076; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072; &#1060;&#1080;&#1083;&#1080;&#1085;&#1072; &#1057;.&#1057;. &#1074; &#1086;&#1090;&#1076;&#1077;&#1083; &#1085;&#1086;&#1084;&#1077;&#1088; 3 &#1089; &#1091;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;&#1084; &#1079;&#1072;&#1088;&#1072;&#1073;&#1086;&#1090;&#1085;&#1086;&#1081; &#1087;&#1083;&#1072;&#1090;&#1099; &#1074; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1077; 45 000 &#1088;&#1091;&#1073;&#1083;&#1077;&#1081;, &#1087;&#1088;&#1077;&#1076;&#1074;&#1072;&#1088;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086; &#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1080;&#1074; &#1077;&#1075;&#1086; &#1085;&#1072;&#1083;&#1080;&#1095;&#1080;&#1077; &#1074; &#1073;&#1072;&#1079;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;. &#1057; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099; &#1080;&#1083;&#1080; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1084;&#1086;&#1078;&#1085;&#1086; &#1101;&#1090;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;? &#1055;&#1086;&#1095;&#1077;&#1084;&#1091;? &#1042; &#1086;&#1089;&#1085;&#1086;&#1074;&#1085;&#1086;&#1081; &#1087;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1077; &#1074;&#1099;&#1079;&#1074;&#1072;&#1090;&#1100; &#1076;&#1072;&#1085;&#1085;&#1091;&#1102; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1091; (&#1080;&#1083;&#1080; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102;) &#1080; &#1087;&#1088;&#1086;&#1082;&#1086;&#1084;&#1084;&#1077;&#1085;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1099;.<br>
<br>
CERATE PROCEDURE transfer<br>
@fio VARCHAR(50), @salary DECIMAL (8,2), @dep INT, @b VARCHAR (6) OUTPUT<br>
AS<br>
BEGIN<br>
SET @n = '&#1091;&#1089;&#1087;&#1077;&#1093;'<br>
IF EXISTS (SELECT * FROM Sotr WHERE FIO = @fio)<br>
UPDATE Sotr<br>
SET Salary = @salary, Dep = @dep WHERE FIO = @fio <br>
ELSE<br>
SET @b = '&#1087;&#1088;&#1086;&#1074;&#1072;&#1083;'<br>
END<br>
DECLARE @status VARCHAR(6)<br>
EXEC transfer '&#1060;&#1080;&#1083;&#1080;&#1085; &#1057;.&#1057;.', 45000, 3, @status OUTPUT<br>
PRINT @status<br>
<br>
<div style ="margin-left:160px;"><font color ="#ffbf00"><b>5 &#1057;&#1045;&#1052;&#1048;&#1053;&#1040;&#1056;</b></font><br>
</div><br>
<b>&#1058;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;&#1099;</b><br>
<b>1 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077; </b><br>
&#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1087;&#1088;&#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1080; &#1082; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; Sotr &#1085;&#1086;&#1074;&#1086;&#1075;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072; &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080; &#1089;&#1086;&#1093;&#1088;&#1072;&#1085;&#1103;&#1077;&#1090; &#1095;&#1072;&#1089;&#1090;&#1080;&#1095;&#1085;&#1099;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1086; &#1085;&#1077;&#1084; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; &#1094;&#1095;&#1077;&#1090;&#1072; &#1087;&#1088;&#1080;&#1077;&#1084;&#1072;-&#1091;&#1074;&#1086;&#1083;&#1100;&#1085;&#1077;&#1085;&#1080;&#1103; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; Journal (id &#1079;&#1072;&#1087;&#1080;&#1089;&#1080; (&#1089;&#1095;&#1077;&#1090;&#1095;&#1080;&#1082;), Sotr_id, FIO, Birthday, DateBeg (&#1076;&#1072;&#1090;&#1072; &#1087;&#1088;&#1080;&#1077;&#1084;&#1072;), DateEnd (&#1091;&#1074;&#1086;&#1083;&#1100;&#1085;&#1077;&#1085;&#1080;&#1103;)).<br>
<br>
CREATE TRIGGER Tr_1<br>
ON Sotr AFTER INSERT<br>
AS<br>
BEGIN<br>
<div style ="margin-left:32px;">INSERT INTO Journal (Sotr_id, FIO, Birthday, DateBeg)<br>
</div><div style ="margin-left:32px;">SELECT Sotr_id, FIO, Birthday, GETDATE() FROM Inserted<br>
</div>END<br>
<br>
<b>2 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;</b><br>
&#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1087;&#1088;&#1080; &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;&#1080;&#1080; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072; &#1080;&#1079; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099; Sotr &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080; &#1079;&#1072;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1091; Journal &#1076;&#1072;&#1090;&#1091; &#1091;&#1074;&#1086;&#1083;&#1100;&#1085;&#1077;&#1085;&#1080;&#1103; &#1076;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072;.<br>
<br>
CREATE TRIGGER Tr_2<br>
ON Sotr AFTER DELETE<br>
AS<br>
BEGIN<br>
<div style ="margin-left:32px;">UPDATE Journal<br>
</div><div style ="margin-left:32px;">SET DataEnd = GETDATE() WHERE Sotr_id IN (SELECT Sotr_id FROM Deleted)<br>
</div>END<br>
<br>
<b>3 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;</b><br>
&#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1087;&#1088;&#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1080; &#1082; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; Sotr &#1085;&#1086;&#1074;&#1086;&#1075;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072; &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080; &#1074;&#1099;&#1095;&#1080;&#1089;&#1083;&#1103;&#1077;&#1090; &#1086;&#1073;&#1097;&#1077;&#1077; &#1095;&#1080;&#1089;&#1083;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; &#1074; &#1090;&#1086;&#1084; &#1086;&#1090;&#1076;&#1077;&#1083;&#1077;, &#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1073;&#1099;&#1083; &#1079;&#1072;&#1095;&#1080;&#1089;&#1083;&#1077;&#1085; &#1101;&#1090;&#1086;&#1090; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;. &#1044;&#1072;&#1085;&#1085;&#1086;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1092;&#1080;&#1082;&#1089;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; DepSotr (&#1085;&#1086;&#1084;&#1077;&#1088; &#1086;&#1090;&#1076;&#1077;&#1083;&#1072; NDep, &#1095;&#1080;&#1089;&#1083;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; Size), &#1077;&#1089;&#1083;&#1080; &#1089;&#1090;&#1088;&#1086;&#1082;&#1072; &#1089; &#1090;&#1072;&#1082;&#1080;&#1084; &#1086;&#1090;&#1076;&#1077;&#1083;&#1086;&#1084; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090;, &#1080;&#1083;&#1080; &#1089;&#1086;&#1079;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1086;&#1074;&#1072;&#1103; &#1079;&#1072;&#1087;&#1080;&#1089;&#1100; &#1089; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1084;&#1080; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;&#1084;&#1080;.<br>
<br>
CREATE TRIGGER Tr_3<br>
ON Sotr AFTER INSERT<br>
AS<br>
BEGIN<br>
<div style ="margin-left:32px;">DECLARE @NDep INT<br>
</div><div style ="margin-left:32px;">SELECT @NDep = Dep FROM Inserted<br>
</div><div style ="margin-left:32px;">IF EXISTS (SELECT * FROM DepSotr WHERE Dep = @Ndep)<br>
</div><div style ="margin-left:64px;">UPDATE DepSotr <br>
</div><div style ="margin-left:64px;">SET Size = Size + 1<br>
</div><div style ="margin-left:64px;">WHERE Dep = @NDep<br>
</div><div style ="margin-left:32px;">ELSE INSERT INTO DepSotr VALUES (@NDep, SELECT COUNT (*) FROM DepSotr WHERE Dep = @NDep)<br>
</div>END<br>
<br>
<b>4 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;</b><br>
&#1056;&#1072;&#1079;&#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1087;&#1088;&#1080; &#1091;&#1076;&#1072;&#1083;&#1077;&#1085;&#1080;&#1080; &#1080;&#1079; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099; Sotr &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072; &#1072;&#1074;&#1090;&#1086;&#1084;&#1072;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080; &#1091;&#1084;&#1077;&#1085;&#1100;&#1096;&#1072;&#1077;&#1090; &#1086;&#1073;&#1097;&#1077;&#1077; &#1095;&#1080;&#1089;&#1083;&#1086; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1086;&#1074; &#1074; &#1086;&#1090;&#1076;&#1077;&#1083;&#1077;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077; &#1092;&#1080;&#1082;&#1089;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; DepSotr. &#1045;&#1089;&#1083;&#1080; &#1086;&#1090;&#1076;&#1077;&#1083; &#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1080;&#1090;&#1089;&#1103; &#1087;&#1091;&#1089;&#1090;&#1099;&#1084;, &#1090;&#1086; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1072;&#1103; &#1086;&#1090;&#1076;&#1077;&#1083;&#1091; &#1089;&#1090;&#1088;&#1086;&#1082;&#1072; &#1091;&#1076;&#1072;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1080;&#1079; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099; DepSotr.<br>
<br>
CREATE TRIGGER Tr_4<br>
ON Sotr AFTER DELETE<br>
AS<br>
BEGIN<br>
<div style ="margin-left:32px;">UPDATE DepSotr<br>
</div><div style ="margin-left:32px;">SET Size = Size - 1<br>
</div><div style ="margin-left:32px;">WHERE NDep IN (SELECT Dep FROM Deleted)<br>
</div><div style ="margin-left:32px;">IF EXISTS (SELECT * FROM DepSotr WHERE Size = 0)<br>
</div><div style ="margin-left:64px;">DELETE FROM DepSotr WHERE Size = 0<br>
</div>END<br>
<br>
<b>5 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;</b><br>
&#1057;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1079;&#1072;&#1087;&#1088;&#1077;&#1097;&#1072;&#1077;&#1090; &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077; &#1087;&#1086;&#1083;&#1103; Salary, &#1077;&#1089;&#1083;&#1080; &#1077;&#1075;&#1086; &#1085;&#1086;&#1074;&#1086;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1087;&#1088;&#1077;&#1074;&#1099;&#1096;&#1072;&#1077;&#1090; &#1089;&#1090;&#1072;&#1088;&#1086;&#1077; &#1073;&#1086;&#1083;&#1077;&#1077; &#1095;&#1077;&#1084; &#1085;&#1072; 10 000, &#1080; &#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1080;&#1090;&#1100;, &#1095;&#1090;&#1086; &#1086;&#1073;&#1085;&#1086;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1086;&#1076;&#1085;&#1072; &#1089;&#1090;&#1088;&#1086;&#1082;&#1072;.<br>
<br>
CREATE TRIGGER&nbsp; Tr_5<br>
ON Sotr AFTER UPDATE<br>
AS BEGIN<br>
<div style ="margin-left:32px;">IF (SELECT (*) FROM Inserted) &gt; 1<br>
</div><div style ="margin-left:32px;">BEGIN<br>
</div><div style ="margin-left:64px;">PRINT ('&#1053;&#1091;&#1078;&#1077;&#1085; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1086;&#1076;&#1080;&#1085; &#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;')<br>
</div><div style ="margin-left:64px;">RILLBACK TRANSACTION<br>
</div><div style ="margin-left:64px;">RETURN<br>
</div><div style ="margin-left:32px;">END<br>
</div><div style ="margin-left:32px;">DECLARE @N INT, @O INT<br>
</div><div style ="margin-left:32px;">SELECT @N = Salary FROM Inserted<br>
</div><div style ="margin-left:32px;">SELECT @O = Salary FROM Deleted<br>
</div><div style ="margin-left:32px;">IF (@N &gt; @O + 10000)<br>
</div><div style ="margin-left:32px;">BEGIN<br>
</div><div style ="margin-left:64px;">PRINT ('&#1057;&#1083;&#1080;&#1096;&#1082;&#1086;&#1084; &#1073;&#1086;&#1083;&#1100;&#1096;&#1072;&#1103; &#1079;&#1072;&#1088;&#1087;&#1083;&#1072;&#1090;&#1072;')<br>
</div><div style ="margin-left:64px;">ROLLBACK TRANSACTION<br>
</div><div style ="margin-left:32px;">END<br>
</div>END<br>
<br>
<b>6 &#1079;&#1072;&#1076;&#1072;&#1085;&#1080;&#1077;</b><br>
&#1042; &#1073;&#1072;&#1079;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1077;&#1089;&#1090;&#1100; 2 &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1099;: &#1052;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1077; (&#1050;&#1086;&#1076;, &#1053;&#1072;&#1079;&#1074;&#1072;&#1085;&#1080;&#1077;, &#1053;&#1072;&#1095;&#1072;&#1083;&#1086;, &#1050;&#1086;&#1085;&#1077;&#1094;) &#1080; &#1041;&#1080;&#1083;&#1077;&#1090; (&#1053;&#1086;&#1084;&#1077;&#1088;, &#1050;&#1086;&#1076;_&#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103;, &#1044;&#1072;&#1090;&#1072;_&#1087;&#1086;&#1089;&#1077;&#1097;&#1077;&#1085;&#1080;&#1103;). &#1057;&#1086;&#1079;&#1076;&#1072;&#1090;&#1100; &#1090;&#1088;&#1080;&#1075;&#1075;&#1077;&#1088;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1087;&#1088;&#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1080; &#1080;&#1083;&#1080; &#1080;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1074; &#1090;&#1072;&#1073;&#1083;&#1080;&#1094;&#1077; &#1041;&#1080;&#1083;&#1077;&#1090; &#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1077;&#1090; &#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100; &#1074;&#1074;&#1077;&#1076;&#1077;&#1085;&#1085;&#1086;&#1075;&#1086; &#1085;&#1086;&#1084;&#1077;&#1088;&#1072; &#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103;, &#1072; &#1090;&#1072;&#1082;&#1078;&#1077; &#1090;&#1086;, &#1095;&#1090;&#1086; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1089;&#1090;&#1086;&#1083;&#1073;&#1094;&#1072; &#1044;&#1072;&#1090;&#1072;_&#1087;&#1086;&#1089;&#1077;&#1097;&#1077;&#1085;&#1080;&#1103; &#1085;&#1077; &#1074;&#1099;&#1093;&#1086;&#1076;&#1080;&#1090; &#1079;&#1072; &#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1099; &#1087;&#1088;&#1086;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1103; &#1076;&#1072;&#1085;&#1085;&#1086;&#1075;&#1086; &#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103;.<br>
<br>
CREATE TRIGGER Tr_6<br>
ON &#1041;&#1080;&#1083;&#1077;&#1090; AFTER UPDATE, INSERT<br>
AS BEGIN<br>
<div style ="margin-left:32px;">DECLARE @id INT<br>
</div><div style ="margin-left:32px;">IF ((SELECT &#1050;&#1086;&#1076;_&#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103; FROM Inserted) NOT IN (SELECT &#1050;&#1086;&#1076; FROM &#1052;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1090;&#1080;&#1077;))<br>
</div><div style ="margin-left:32px;">BEGIN<br>
</div><div style ="margin-left:64px;">ROLLBACK TRANSACTION<br>
</div><div style ="margin-left:64px;">RETURN<br>
</div><div style ="margin-left:32px;">END<br>
</div><div style ="margin-left:32px;">SET @id = (SELECT &#1050;&#1086;&#1076;_&#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103; FROM Inserted)<br>
</div><div style ="margin-left:32px;">IF ((SELECT &#1044;&#1072;&#1090;&#1072;_&#1087;&#1086;&#1089;&#1077;&#1097;&#1077;&#1085;&#1080;&#1103; FROM Inserted) BETWEEN (SELECT &#1053;&#1072;&#1095;&#1072;&#1083;&#1086; FROM &#1052;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1077; WHERE &#1050;&#1086;&#1076;_&#1084;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1103; = @id) AND (SELECT &#1050;&#1086;&#1085;&#1077;&#1094; FROM &#1052;&#1077;&#1088;&#1086;&#1087;&#1088;&#1080;&#1103;&#1090;&#1080;&#1077; WHERE &#1050;&#1086;&#1076; = @id)<br>
</div></div>
</body>
</html>